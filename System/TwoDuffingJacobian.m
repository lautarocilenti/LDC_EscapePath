function [res] = TwoDuffingJacobian(x1,x2,M)


Jf = @(a1,a3,kc,nu,p2,p4,q1,q3)reshape([0.0,-a1-kc-a3.*q1.^2.*3.0,0.0,kc,a3.*p2.*q1.*4.0,0.0,0.0,0.0,1.0,-nu,0.0,0.0,0.0,0.0,0.0,0.0,0.0,kc,0.0,-a1-kc-a3.*q3.^2.*3.0,0.0,0.0,a3.*p4.*q3.*4.0,0.0,0.0,0.0,1.0,-nu,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-1.0,0.0,0.0,0.0,-1.0,0.0,0.0,a1+kc+a3.*q1.^2.*2.0,nu,-kc,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-1.0,0.0,0.0,0.0,-1.0,-kc,0.0,a1+kc+a3.*q3.^2.*2.0,nu],[8,8]);

res = Jf(M.a1,M.a3,M.kc,M.nu,0,0,x1,x2);
end

